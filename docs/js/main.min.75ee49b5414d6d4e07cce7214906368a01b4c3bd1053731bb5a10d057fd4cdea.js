(function(a){'use strict';a(document).ready(function(){const c=a('html').attr('lang'),b=a('.cp-search-bar-field');if(b&&b.length){b.data('html',!0),b.data('placement','bottom'),b.data('template','<div class="popover offline-search-result" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'),b.on('change',c=>{f(a(c.target)),b.blur()}),b.closest('form').on('submit',()=>!1);let d=null;const e=new Map;a.ajax(b.data('offline-search-index-json-src')).then(a=>{d=lunr(function(){this.ref('ref'),this.field('title',{boost:5}),this.field('description',{boost:2}),this.field('body'),this.field('language'),a.forEach(a=>{this.add(a),e.set(a.ref,{title:a.title,excerpt:a.excerpt,language:a.language})})}),b.trigger('change')});const f=f=>{if(a('.cp-search-results').remove(),d===null)return;const g=f.val();if(g==='')return;const j=d.query(a=>{const b=lunr.tokenizer(g.toLowerCase());b.forEach(c=>{const b=c.toString();a.term(b,{boost:100}),a.term(b,{wildcard:lunr.Query.wildcard.LEADING|lunr.Query.wildcard.TRAILING,boost:10}),a.term(b,{editDistance:2})}),a.term(`content/${c}`,{fields:['language'],wildcard:lunr.Query.wildcard.LEADING|lunr.Query.wildcard.TRAILING,presence:lunr.Query.presence.REQUIRED})}).slice(0,f.data('offline-search-max-results')),k=a('<div class="cp-search-results">'),h=a('<div class="cp-search-results-found">');a('.cp-search').append(k),k.append(h),j.length===0?h.append(a('<p>').text(`No results found for query "${g}"`)):j.forEach((c,d)=>{if(d<=3){const g=e.get(c.ref),f=b.data('offline-search-base-href'),i=f+c.ref.replace(/^\//,''),d=a('<div>').addClass('row justify-content-between align-items-center cp-search-results-found-item');d.append(a('<span>').addClass('col-auto cp-search-results-found-item-title').text(g.title)),d.append(a('<span>').addClass('col-auto').append(`<a href="${c.ref}"><img src="${f}/icons/arrow-right.svg" alt="Ir"></a>`)),h.append(d)}});const i=()=>{f.val(''),f.trigger('change')};a('.cp-search-bar-button').on('click',()=>{i()}),a(document).keydown(function(a){a.keyCode==27&&i()}),a(document).click(b=>{a(b.target).closest('.cp-search').length||i()})}}})})(jQuery)